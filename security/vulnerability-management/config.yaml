# GamifyX Vulnerability Management Configuration

# General settings
project_name: "GamifyX AIOps Learning Platform"
project_version: "1.0.0"
organization: "GamifyX Security Team"

# Scanning configuration
scanning:
  # Vulnerability sources to use
  sources:
    - trivy
    - semgrep
    - eslint
    - checkov
    - truffleHog
    - osv
    - nvd
  
  # Severity levels to include
  severity_levels:
    - CRITICAL
    - HIGH
    - MEDIUM
    - LOW
  
  # File patterns to include
  include_patterns:
    - "**/*.js"
    - "**/*.ts"
    - "**/*.jsx"
    - "**/*.tsx"
    - "**/*.py"
    - "**/*.go"
    - "**/*.java"
    - "**/*.dockerfile"
    - "**/Dockerfile*"
    - "**/*.yaml"
    - "**/*.yml"
    - "**/*.json"
    - "**/*.toml"
    - "**/*.tf"
    - "**/*.lock"
  
  # Paths to exclude from scanning
  exclude_paths:
    - "node_modules/**"
    - ".git/**"
    - "dist/**"
    - "build/**"
    - "coverage/**"
    - "logs/**"
    - "tmp/**"
    - "*.test.js"
    - "*.test.ts"
    - "*.spec.js"
    - "*.spec.ts"

# Risk assessment configuration
risk_assessment:
  # ML model settings
  ml_model:
    enabled: true
    model_type: "random_forest"
    retrain_interval_days: 30
    confidence_threshold: 0.7
  
  # Risk scoring weights
  scoring_weights:
    cvss_score: 0.3
    severity: 0.2
    exploitability: 0.2
    business_impact: 0.2
    component_criticality: 0.1
  
  # Business context
  business_context:
    # Component criticality levels (1-5)
    component_criticality:
      "api-gateway": 5
      "user-service": 5
      "auth-service": 5
      "gamification-service": 4
      "submission-service": 4
      "feedback-service": 4
      "analytics-service": 4
      "competition-service": 3
      "notification-service": 3
      "frontend": 4
      "database": 5
      "redis": 4
      "monitoring": 3
    
    # Data sensitivity levels
    sensitive_data_components:
      - "user-service"
      - "auth-service"
      - "analytics-service"
      - "database"
    
    # Internet-facing components
    internet_facing_components:
      - "frontend"
      - "api-gateway"
      - "cdn"
    
    # Compliance-critical components
    compliance_components:
      - "user-service"
      - "auth-service"
      - "analytics-service"
      - "audit-service"

# Remediation configuration
remediation:
  # Automatic remediation settings
  auto_remediation:
    enabled: true
    max_concurrent_fixes: 3
    timeout_minutes: 30
    
    # Risk thresholds for auto-remediation
    risk_thresholds:
      critical: 9.0
      high: 7.0
      medium: 4.0
      low: 0.1
    
    # Component-specific thresholds
    component_thresholds:
      "api-gateway": 8.0
      "user-service": 8.0
      "auth-service": 8.0
      "database": 9.0
      "frontend": 6.0
  
  # Remediation strategies
  strategies:
    - type: "dependency_update"
      priority: 1
      enabled: true
      conditions:
        - "severity >= HIGH"
        - "fix_available = true"
        - "breaking_change = false"
      max_version_jump: "minor"
      test_required: true
      rollback_on_failure: true
    
    - type: "configuration_fix"
      priority: 2
      enabled: true
      conditions:
        - "severity >= MEDIUM"
        - "auto_fixable = true"
      backup_required: true
      validation_required: true
    
    - type: "base_image_update"
      priority: 3
      enabled: true
      conditions:
        - "severity >= HIGH"
        - "image_update_available = true"
      rebuild_required: true
      test_required: true
    
    - type: "code_fix"
      priority: 4
      enabled: false  # Manual review required
      conditions:
        - "severity >= HIGH"
        - "code_pattern_match = true"
    
    - type: "manual_review"
      priority: 5
      enabled: true
      conditions:
        - "severity >= CRITICAL"
        - "breaking_change = true"
      create_ticket: true
      assign_to: "security-team"

# Testing configuration
testing:
  # Test suites to run after remediation
  test_suites:
    - name: "unit_tests"
      command: "npm test"
      timeout_minutes: 10
      required: true
      paths:
        - "frontend"
        - "services/*"
    
    - name: "integration_tests"
      command: "npm run test:integration"
      timeout_minutes: 15
      required: true
      paths:
        - "tests/integration"
    
    - name: "security_tests"
      command: "npm run test:security"
      timeout_minutes: 20
      required: true
      paths:
        - "tests/security"
    
    - name: "e2e_tests"
      command: "npm run test:e2e"
      timeout_minutes: 30
      required: false
      paths:
        - "tests/e2e"
  
  # Performance benchmarks
  performance_tests:
    enabled: true
    baseline_file: "tests/performance/baseline.json"
    max_regression_percent: 10
    timeout_minutes: 15

# Notification configuration
notifications:
  # Slack integration
  slack:
    enabled: true
    webhook_url: "${SLACK_WEBHOOK_URL}"
    channel: "#security-alerts"
    notify_on:
      - "critical_vulnerability_found"
      - "remediation_applied"
      - "remediation_failed"
      - "scan_completed"
    
    # Message templates
    templates:
      critical_vulnerability: |
        üö® *Critical Vulnerability Detected*
        
        *Component*: {component}
        *Vulnerability*: {vulnerability_id}
        *CVSS Score*: {cvss_score}
        *Risk Score*: {risk_score}
        
        *Description*: {description}
        *Recommendation*: {recommendation}
      
      remediation_success: |
        ‚úÖ *Vulnerability Remediation Successful*
        
        *Component*: {component}
        *Vulnerability*: {vulnerability_id}
        *Action*: {remediation_action}
        *Status*: Fixed
      
      remediation_failure: |
        ‚ùå *Vulnerability Remediation Failed*
        
        *Component*: {component}
        *Vulnerability*: {vulnerability_id}
        *Error*: {error_message}
        *Action Required*: Manual intervention needed
  
  # Email notifications
  email:
    enabled: false
    smtp_server: "smtp.company.com"
    smtp_port: 587
    username: "${EMAIL_USERNAME}"
    password: "${EMAIL_PASSWORD}"
    from_address: "security@gamifyx.com"
    to_addresses:
      - "security-team@gamifyx.com"
      - "devops@gamifyx.com"
  
  # GitHub integration
  github:
    enabled: true
    token: "${GITHUB_TOKEN}"
    repository: "gamifyx/platform"
    create_issues: true
    create_pull_requests: true
    
    # PR template
    pr_template: |
      ## Security Vulnerability Fix
      
      This PR addresses {vulnerability_count} security vulnerabilities:
      
      {vulnerability_list}
      
      ### Changes Made:
      {changes_summary}
      
      ### Testing:
      - [x] Automated tests passed
      - [x] Security validation completed
      - [x] Performance impact assessed
      
      **Risk Level**: {max_severity}
      **Auto-generated by**: GamifyX Vulnerability Management System
    
    # Issue template
    issue_template: |
      ## Security Vulnerability Report
      
      **Vulnerability ID**: {vulnerability_id}
      **Component**: {component}
      **Severity**: {severity}
      **CVSS Score**: {cvss_score}
      **Risk Score**: {risk_score}
      
      ### Description
      {description}
      
      ### Recommendation
      {recommendation}
      
      ### Additional Information
      - **Exploitability**: {exploitability}
      - **Business Impact**: {business_impact}
      - **Fixed Version**: {fixed_version}
      
      ### References
      {references}

# Reporting configuration
reporting:
  # Output formats
  formats:
    - json
    - html
    - pdf
    - sarif
    - csv
  
  # Report templates
  templates:
    executive_summary: "templates/executive-summary.html"
    technical_details: "templates/technical-details.html"
    remediation_plan: "templates/remediation-plan.html"
    compliance_report: "templates/compliance-report.html"
  
  # Metrics to include
  metrics:
    - total_vulnerabilities
    - vulnerabilities_by_severity
    - vulnerabilities_by_component
    - remediation_success_rate
    - mean_time_to_remediation
    - compliance_score
    - risk_score_distribution
    - top_vulnerable_components
  
  # Dashboard settings
  dashboard:
    enabled: true
    refresh_interval_minutes: 15
    charts:
      - vulnerability_trends
      - risk_score_distribution
      - remediation_effectiveness
      - compliance_status
      - component_security_scores

# Compliance configuration
compliance:
  # Frameworks to assess against
  frameworks:
    - NIST
    - ISO27001
    - SOC2
    - GDPR
    - FERPA
    - PCI_DSS
  
  # Control mappings
  control_mappings:
    vulnerability_management:
      NIST: ["PR.IP-12", "DE.CM-8"]
      ISO27001: ["A.12.6"]
      SOC2: ["CC6.6"]
    
    incident_response:
      NIST: ["RS.RP-1", "RS.CO-2"]
      ISO27001: ["A.16.1"]
      SOC2: ["CC7.4"]
  
  # Compliance thresholds
  thresholds:
    critical_vulnerabilities: 0
    high_vulnerabilities: 5
    medium_vulnerabilities: 20
    remediation_sla_days: 30
    scan_frequency_days: 1

# Integration configuration
integrations:
  # SIEM integration
  siem:
    enabled: false
    type: "splunk"  # splunk, elastic, qradar
    endpoint: "${SIEM_ENDPOINT}"
    api_key: "${SIEM_API_KEY}"
  
  # Ticketing system
  ticketing:
    enabled: false
    type: "jira"  # jira, servicenow, github
    url: "${JIRA_URL}"
    username: "${JIRA_USERNAME}"
    token: "${JIRA_TOKEN}"
    project: "SEC"
    issue_type: "Security Vulnerability"
  
  # Metrics and monitoring
  metrics:
    prometheus:
      enabled: true
      pushgateway_url: "${PROMETHEUS_PUSHGATEWAY_URL}"
      job_name: "vulnerability-management"
    
    grafana:
      enabled: true
      dashboard_id: "vulnerability-management"
      api_url: "${GRAFANA_API_URL}"
      api_key: "${GRAFANA_API_KEY}"

# Storage configuration
storage:
  # Report retention
  retention:
    scan_results_days: 90
    reports_days: 365
    logs_days: 30
    sbom_days: 180
  
  # Backup settings
  backup:
    enabled: true
    location: "s3://gamifyx-security-backups"
    encryption: true
    compression: true

# Advanced settings
advanced:
  # Parallel processing
  parallel_processing:
    enabled: true
    max_workers: 4
    chunk_size: 100
  
  # Caching
  caching:
    enabled: true
    ttl_hours: 24
    max_size_mb: 500
  
  # Rate limiting
  rate_limiting:
    api_calls_per_minute: 60
    concurrent_scans: 3
  
  # Debugging
  debug:
    enabled: false
    log_level: "INFO"
    save_intermediate_files: false